---
title: Laohalduse vabade kirjete puhastustöö
description: Selles teemas kirjeldatakse vabade kirjete puhastustööd, mis aitab parandada süsteemi jõudlust, tuvastades ja kustutades seotud, kuid mittevajalikud kirjed.
author: perlynne
manager: tfehr
ms.date: 04/23/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.search.region: Global
ms.author: perlynne
ms.search.validFrom: 2020-04-03
ms.dyn365.ops.version: Release 10.0.12
ms.openlocfilehash: f6d1f8a4c85c2161d1b79246d437bb3b4d223d1d
ms.sourcegitcommit: a3cd2783ae120ac6681431c010b9b126a9ca7d94
ms.translationtype: HT
ms.contentlocale: et-EE
ms.lasthandoff: 05/29/2020
ms.locfileid: "3410941"
---
# <a name="warehouse-management-on-hand-entries-cleanup-job"></a><span data-ttu-id="bc0aa-103">Laohalduse vabade kirjete puhastustöö</span><span class="sxs-lookup"><span data-stu-id="bc0aa-103">Warehouse management on-hand entries cleanup job</span></span>

<span data-ttu-id="bc0aa-104">Vabade varude arvutamiseks kasutatavat päringute jõudlust mõjutab kaasatud tabelites sisalduvate kirjete arv.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-104">The performance of queries that are used to calculate on-hand inventory is affected by the number of records in the tables that are involved.</span></span> <span data-ttu-id="bc0aa-105">Üks viis jõudluse parandamiseks on vähendada kirjete arvu, mida andmebaas peab arvestama.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-105">One way to help improve the performance is to reduce the number of records that the database must consider.</span></span>

<span data-ttu-id="bc0aa-106">Selles teemas kirjeldatakse vabade kirjete puhastustööd, mille käigus kustutatakse tabelitest InventSum ja WHSInventReserve ebavajalikud kirjed.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-106">This topic describes the on-hand entries cleanup job, which deletes unneeded records in the InventSum and WHSInventReserve tables.</span></span> <span data-ttu-id="bc0aa-107">Antud tabelid talletavad laohalduse töötlemise jaoks lubatud kaupade vabade varude teavet.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-107">These tables store on-hand information for items that are enabled for warehouse management processing.</span></span> <span data-ttu-id="bc0aa-108">(Neid kaupu nimetatakse WHS kaupadeks.) Antud kirjete kustutamine võib parandada märkimisväärselt vabade varude arvutuste jõudlust.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-108">(These items are referred to as WHS items.) Deletion of these records can significantly improve the performance of on-hand calculations.</span></span>

## <a name="what-the-cleanup-job-does"></a><span data-ttu-id="bc0aa-109">Puhastustöö otstarve</span><span class="sxs-lookup"><span data-stu-id="bc0aa-109">What the cleanup job does</span></span>

<span data-ttu-id="bc0aa-110">Vabade kirjete puhastustöö käigus kustutatakse kõik tabelis WHSInventReserve ja InventSum sisalduvad kirjed, kus kõik väljaväärtused on *0* (null).</span><span class="sxs-lookup"><span data-stu-id="bc0aa-110">The on-hand entries cleanup job deletes any records in the WHSInventReserve and InventSum tables where all the field values are *0* (zero).</span></span> <span data-ttu-id="bc0aa-111">Need kirjed võib kustutada, kuna need ei anna vabade varude teabele midagi juurde.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-111">These records can be deleted because they don't contribute to the on-hand information.</span></span> <span data-ttu-id="bc0aa-112">Töö käigus kustutatakse vaid kirjed, mille tase jääb alla taseme **Asukoht**.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-112">The job deletes only records that are below the **Location** level.</span></span>

<span data-ttu-id="bc0aa-113">Negatiivseete füüsiliste varude lubamise korral ei pruugita puhastustöö käigus kustutada kõiki asjakohaseid kandeid.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-113">If negative physical inventory is allowed, the cleanup job might not be able to delete all the relevant entries.</span></span> <span data-ttu-id="bc0aa-114">Selle piirangu põhjuseks on tõsiasi, et töö peab võimaldama eristsenaariumit, kus litsentsiplaadil on mitu seerianumbrit ja üks neist seerianumbritest on muutunud negatiivseks.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-114">The reason for this limitation is that the job must allow for a special scenario where a license plate has multiple serial numbers, and one of those serial numbers has become negative.</span></span> <span data-ttu-id="bc0aa-115">Näiteks on süsteemis litsentsiplaadi tasemel vabade varude väärtus null, kui litsentsiplaadil on +1 tk seerianumbrit 1 ja -1 tk seerianumbrit 2.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-115">For example, the system will have zero on hand at the license plate level when a license plate has +1 pcs of serial number 1 and –1 pcs of serial number 2.</span></span> <span data-ttu-id="bc0aa-116">Antud eristsenaariumi korral teostatakse töö raames esmalt ulatusepõhine kustutamine, kus üritatakse kustutada esmalt madalamatest tasemetest.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-116">For this special scenario, the job does a breadth-first deletion, where it tries to delete from lower levels first.</span></span>

## <a name="schedule-and-configure-the-cleanup-job"></a><span data-ttu-id="bc0aa-117">Puhastustöö kavandamine ja konfigureerimine</span><span class="sxs-lookup"><span data-stu-id="bc0aa-117">Schedule and configure the cleanup job</span></span>

<span data-ttu-id="bc0aa-118">Vabade varude puhastustöö on saadaval asukohas **Varude haldus \> Perioodilised ülesanded \> Puhastus \> Laohalduse vabade kirjete puhastustöö**.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-118">The on-hand entries cleanup job is available at **Inventory management \> Periodic tasks \> Clean up \> Warehouse management on-hand entries cleanup**.</span></span> <span data-ttu-id="bc0aa-119">Töö käitamise ulatuse ja graafiku kontrollimiseks kasutage tavapäraseid töösätteid.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-119">Use the standard job settings to control the scope and schedule for running the job.</span></span> <span data-ttu-id="bc0aa-120">Lisaks pakutakse järgmisi sätteid.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-120">In addition, the following settings are provided:</span></span>

- <span data-ttu-id="bc0aa-121">**Kustutada, kui pole värskendatud antud arv päevi** – sisestage minimaalne päevade arv, kui kaua töö peaks ootama enne nullkoguseni langenud vabade varude kirje kustutamist.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-121">**Delete if not updated for this many days** – Enter the minimum number of days that the job should wait before it deletes an on-hand entry that has dropped to zero quantity.</span></span> <span data-ttu-id="bc0aa-122">Kasutage seda sätet, et vähendada kasutatavate vabade varude kirjete kustutamise ohtu.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-122">Use this setting to help reduce the risk of deleting on-hand entries that are still being used.</span></span> <span data-ttu-id="bc0aa-123">Kui soovite teostada puhastustöö esimesel võimalusel, siis sisestage väärtuseks *0* (null) või jätke väli tühjaks.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-123">If you want cleanup to occur as soon as possible, either enter *0* (zero) or leave the field blank.</span></span>
- <span data-ttu-id="bc0aa-124">**Maksimaalne teostamisaeg (tundides)** – sisestage puhastustöö maksimaalne teostamisaeg tundides.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-124">**Maximum execution time (hours)** – Enter the maximum execution time of the cleanup job, in hours.</span></span> <span data-ttu-id="bc0aa-125">Kui töö ei ole enne selle aja möödumist lõpule viidud, siis salvestatakse seni tehtud töö ja suletakse toiming.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-125">If the job isn't completed before this time passes, it will save the work that it has completed so far and then close itself.</span></span> <span data-ttu-id="bc0aa-126">See võimalus on eriti oluline rakenduste puhul, kus varude kasutamise tase on kõrge.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-126">This capability is especially relevant for implementations that have high inventory use.</span></span> <span data-ttu-id="bc0aa-127">Sellisel juhul tuleb planeerida töö käitamine ajale, mil süsteemi koormus on võimalikult väike.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-127">In these cases, you should schedule the job to run at times when the system load is as light as possible.</span></span> <span data-ttu-id="bc0aa-128">Kui soovite, et partiitöö jätkuks lõpule viimiseni, siis sisestage väärtuseks *0* (null) või jätke väli tühjaks.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-128">If you want the batch job to continue to run until it's completed, either enter *0* (zero) or leave the field blank.</span></span> <span data-ttu-id="bc0aa-129">See säte on saadaval vaid juhul, kui seotud funktsioon on [teie süsteemis sisse lülitatud](#max-execution-time).</span><span class="sxs-lookup"><span data-stu-id="bc0aa-129">This setting is available only if the related feature has been [turned on in your system](#max-execution-time).</span></span>

<span data-ttu-id="bc0aa-130">Kuigi te saate käitada tööd tavatöötundide ajal, siis soovitame seda käitada väljaspool tavatööaega.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-130">Although you can run the job during regular business hours, we recommend that you run it outside working hours.</span></span> <span data-ttu-id="bc0aa-131">See aitab ära hoida võimalikke konflikte, mis võivad tekkida juhul, kui kasutaja töötab kirjega, mida samal ajal ka puhastatakse.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-131">In this way, you help prevent conflicts that can occur if a user is working with a record that is also being cleaned up.</span></span>

<span data-ttu-id="bc0aa-132">Kui töö proovib kustutada kauba kirjet samal ajal, kui teine kasutaja antud kirjet kasutab, siis esineb puhastutöö käigus või kasutaja jaoks tupiktõrge.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-132">If the job tries to delete a record for an item while that record is being used by another user, a deadlock error occurs for either the cleanup job or the user.</span></span>

<span data-ttu-id="bc0aa-133">Töö käitamisel on selle kinnitustase 100.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-133">When the job runs, it has a commit size of 100.</span></span> <span data-ttu-id="bc0aa-134">Teisisõnu püütakse iga 100 kustutamise järel teostada üks kinnitus.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-134">In other words, it will try to commit one time for every 100 deletions.</span></span> <span data-ttu-id="bc0aa-135">Kuna mõned kustutamised on kogumipõhised, siis võib esineda stsenaariume, kus ühe tehingu käigus võidakse kustutada enam kui 100 kirjet.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-135">However, because some deletions are set-based, there might be scenarios where more than 100 records can be deleted in the same transaction.</span></span> <span data-ttu-id="bc0aa-136">Seega võivad aeg-ajalt esineda lukustuslaiendused.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-136">Therefore, lock escalations can still sometimes occur.</span></span>

## <a name="possible-user-impact"></a><span data-ttu-id="bc0aa-137">Võimalik mõju kasutajale</span><span class="sxs-lookup"><span data-stu-id="bc0aa-137">Possible user impact</span></span>

<span data-ttu-id="bc0aa-138">Kui puhastustöö käigus kustutatakse kõik puhastustöö vabade kirjete andmed konkreetse taseme kohta (nt litsentsiplaadi tase), siis võib see mõjutada ka kasutajaid.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-138">Users might be affected if the on-hand entries cleanup job deletes all the records for a given level (such as the license plate level).</span></span> <span data-ttu-id="bc0aa-139">Sellisel juhul ei pruugi antud varude nägemiseks varasemalt litsentsiplaadil saadaolev funktsioon õigesti töötada, kuna asjakohased vabad kirjed ei ole enam saadaval.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-139">In this case, the functionality for seeing that inventory was previously available on hand at a license plate might not work as expected, because the relevant on-hand entries are no longer available.</span></span> <span data-ttu-id="bc0aa-140">(Kui töötaja vaatab vabade varude teavet, siis kontrollib see funktsioon sätete **Dimensiooni kuvamine** all tingimust **Kogus \<\> 0**). Samas peaks puhastustööst tulenevalt paranenud jõudlus selle väikse funktsionaalsuskao tasa tegema.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-140">(That functionality checks the condition **Quantity \<\> 0** in the **Dimension display** settings when users view on-hand information.) However, the performance improvement that the cleanup job provides should make up for this small loss in functionality.</span></span>

## <a name="make-the-maximum-execution-time-setting-available"></a><a name="max-execution-time"></a><span data-ttu-id="bc0aa-141">Maksimaalse teostamisaja kättesaadavaks muutmine</span><span class="sxs-lookup"><span data-stu-id="bc0aa-141">Make the Maximum execution time setting available</span></span>

<span data-ttu-id="bc0aa-142">**Maksimaalse teostamisaja** säte ei ole vaikesättena kättesaadav.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-142">By default, the **Maximum execution time** setting isn't available.</span></span> <span data-ttu-id="bc0aa-143">Kui soovite seda kasutada, peate kasutama [funktsioonihaldust](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md), et lülitada seotud funktsioon oma süsteemis sisse.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-143">If you want to use it, you must use [feature management](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) to turn on the related feature in your system.</span></span> <span data-ttu-id="bc0aa-144">Tööruumis **Funktsioonihaldus** loetletakse funktsiooni järgneval viisil.</span><span class="sxs-lookup"><span data-stu-id="bc0aa-144">In the **Feature management** workspace, the feature is listed in the following way:</span></span>

- <span data-ttu-id="bc0aa-145">**Moodul:** *laohaldus*</span><span class="sxs-lookup"><span data-stu-id="bc0aa-145">**Module:** *Warehouse management*</span></span>
- <span data-ttu-id="bc0aa-146">**Funktsiooni nimi:** *Laohalduse vabade kirjete puhastustöö maksimaalne teostamisaeg*</span><span class="sxs-lookup"><span data-stu-id="bc0aa-146">**Feature name:** *Maximum execution time for the warehouse management on-hand entries cleanup job*</span></span>
